#include stdlib

proc print_from_fd (int -> )
  dup
  16 swap
  mem swap
  sys_read
  dup mem print_str_len
  16 eqi if
    print_from_fd
  else
    drop
  end
end

2 eqi if
  1 get_argv
  0 swap
  0 swap
  sys_open
  dup
  -2 eqi if
    drop
    "cat: No such file" print_str
  else
    dup
    print_from_fd
    sys_close drop
  end
else
  "Usage: cat <file>" print_str drop
end
